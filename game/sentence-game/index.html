<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sentence Unscramble — Fill the Missing Word</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { -webkit-tap-highlight-color: transparent; }
    .letter-tile {
      width: 44px;
      height: 44px;
      min-width:44px;
      min-height:44px;
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:1.05rem;
      user-select:none;
      cursor:pointer;
      transition: background-color 0.2s;
    }
    .letter-tile.held {
      opacity: 0.45;
      transform: scale(.98);
      cursor: default;
      background-color: #374151 !important; /* darker when held */
    }
    .slot {
      min-width: 44px;
      min-height:44px;
      border-radius:8px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      background: rgba(255,255,255,0.04);
      cursor:pointer;
      font-weight:700;
      color: #e6e7e9;
      user-select:none;
    }
    @media (max-width:640px){
      .letter-tile, .slot { width:40px; height:40px; min-width:40px; min-height:40px; font-size:0.95rem; }
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-900 to-slate-800 text-slate-100 flex items-center justify-center p-4">

  <div class="w-full max-w-4xl">
    <header class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4">
      <div>
        <h1 class="text-2xl font-bold">Sentence Unscramble — Fill the Missing Word</h1>
        <p class="text-sm text-slate-300 mt-1">Unscramble the scrambled letters below the sentence. Tap letters or type your answer.</p>
      </div>

      <div class="flex items-center gap-3 mt-3 sm:mt-0">
        <div class="bg-white/5 px-3 py-2 rounded-md text-sm">Score: <span id="score">0</span></div>
        <div class="bg-white/5 px-3 py-2 rounded-md text-sm">Correct: <span id="correct">0</span></div>
        <div class="bg-white/5 px-3 py-2 rounded-md text-sm">Skipped: <span id="skips">0</span></div>
        <div class="bg-white/5 px-3 py-2 rounded-md text-sm">Progress: <span id="index">1</span>/<span id="total">100</span></div>
      </div>
    </header>

    <main class="bg-white/5 p-4 rounded-lg">
      <section class="mb-4">
        <div id="sentence" class="text-lg md:text-xl font-medium leading-relaxed"></div>
      </section>

      <section class="mb-4">
        <!-- Harf kutuları burada, input üstünde -->
        <div id="letters" class="flex flex-wrap gap-2 items-center justify-center mb-3"></div>

        <div class="flex items-center gap-2 mb-4">
          <input id="textInput" type="text" placeholder="Or type your answer here" class="flex-1 p-2 rounded-md bg-slate-900 border border-white/6 focus:outline-none" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" />
          <button id="checkBtn" class="px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-black rounded-md">Check</button>
        </div>

        <!-- Boşluklu slotlar burada -->
        <div class="flex flex-wrap gap-2 justify-center" id="slots"></div>

        <div class="flex gap-2 mt-4 justify-center">
          <button id="shuffleBtn" class="px-3 py-2 bg-slate-700 hover:bg-slate-600 rounded-md">Shuffle</button>
          <button id="skipBtn" class="px-3 py-2 bg-yellow-500 hover:bg-yellow-600 rounded-md">Skip (-5)</button>
          <button id="revealBtn" class="px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md">Reveal (end)</button>
          <button id="nextBtn" class="ml-auto px-3 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-md">Next</button>
        </div>

        <p id="feedback" class="mt-3 text-sm h-6 text-center"></p>
      </section>

      <section class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-4 text-sm text-slate-300">
        <div>
          Tip: Tap letter tiles to place them into the blanks. Tap placed letters to remove them back to the pool.
        </div>
        <div class="text-right">
          Built for mobile — swipe won’t be necessary. Works with typing too.
        </div>
      </section>
    </main>
  </div>

<script>
const sentences = [

  // A1 - Very Basic
  { sentence: "I ____ a book.", answer: "have" },
  { sentence: "She ____ happy.", answer: "is" },
  { sentence: "We ____ to school.", answer: "go" },
  { sentence: "They ____ my friends.", answer: "are" },
  { sentence: "He ____ a cat.", answer: "has" },
  { sentence: "I like to ____ football.", answer: "play" },
  { sentence: "It is ____ today.", answer: "sunny" },
  { sentence: "Can you ____ me?", answer: "help" },
  { sentence: "I want to ____ water.", answer: "drink" },
  { sentence: "She ____ a teacher.", answer: "is" },

  // A2 - Elementary
  { sentence: "The weather is ____ cold.", answer: "getting" },
  { sentence: "I usually ____ breakfast at 7 am.", answer: "have" },
  { sentence: "He ____ his homework every day.", answer: "does" },
  { sentence: "They are going to the ____.", answer: "market" },
  { sentence: "Can you ____ me your pen?", answer: "lend" },
  { sentence: "She ____ likes swimming.", answer: "really" },
  { sentence: "We need to ____ early tomorrow.", answer: "leave" },
  { sentence: "He doesn't ____ coffee.", answer: "like" },
  { sentence: "I am ____ to travel next week.", answer: "planning" },
  { sentence: "The cat is ____ under the table.", answer: "sleeping" },

  // B1 - Intermediate
  { sentence: "She was ____ when she heard the news.", answer: "surprised" },
  { sentence: "I have ____ a new job recently.", answer: "started" },
  { sentence: "They decided to ____ abroad.", answer: "move" },
  { sentence: "The movie was really ____ and exciting.", answer: "interesting" },
  { sentence: "He often ____ his friends on weekends.", answer: "visits" },
  { sentence: "I can't ____ to the meeting tomorrow.", answer: "come" },
  { sentence: "She speaks English ____ than before.", answer: "better" },
  { sentence: "The weather ____ quickly changed.", answer: "suddenly" },
  { sentence: "We should ____ a break now.", answer: "take" },
  { sentence: "The food tasted very ____.", answer: "delicious" },

  // B2 - Upper Intermediate
  { sentence: "He gave a very ____ presentation yesterday.", answer: "convincing" },
  { sentence: "They are ____ a new project at work.", answer: "developing" },
  { sentence: "She has a ____ understanding of the topic.", answer: "thorough" },
  { sentence: "I was ____ to hear about the accident.", answer: "shocked" },
  { sentence: "The company decided to ____ the deadline.", answer: "extend" },
  { sentence: "This issue requires immediate ____.", answer: "attention" },
  { sentence: "He showed ____ leadership skills.", answer: "excellent" },
  { sentence: "The proposal was ____ by the board.", answer: "approved" },
  { sentence: "I managed to ____ all my tasks on time.", answer: "complete" },
  { sentence: "They have ____ a strong relationship.", answer: "maintained" },

  // C1 - Advanced
  { sentence: "The new policy aims to ____ economic growth.", answer: "stimulate" },
  { sentence: "She delivered a ____ speech at the conference.", answer: "compelling" },
  { sentence: "The evidence was ____ and convincing.", answer: "substantial" },
  { sentence: "We need to ____ our efforts in this area.", answer: "intensify" },
  { sentence: "He was praised for his ____ contributions.", answer: "significant" },
  { sentence: "The project faced several ____ challenges.", answer: "unforeseen" },
  { sentence: "This theory has been widely ____.", answer: "debated" },
  { sentence: "The results were ____ and unexpected.", answer: "astonishing" },
  { sentence: "She exhibited ____ resilience during hardship.", answer: "remarkable" },
  { sentence: "The study provides ____ insights into behavior.", answer: "valuable" },

  // C2 - Proficient
  { sentence: "The philosopher's argument was highly ____.", answer: "persuasive" },
  { sentence: "The government implemented a ____ reform.", answer: "comprehensive" },
  { sentence: "His writing style is very ____ and sophisticated.", answer: "eloquent" },
  { sentence: "The company faced ____ scrutiny over its practices.", answer: "intense" },
  { sentence: "Her knowledge of linguistics is ____.", answer: "profound" },
  { sentence: "They embarked on a ____ exploration of the subject.", answer: "meticulous" },
  { sentence: "The concept was ____ throughout the manuscript.", answer: "interwoven" },
  { sentence: "He demonstrated ____ mastery of the subject matter.", answer: "exceptional" },
  { sentence: "The proposal was ____ rejected by the committee.", answer: "categorically" },
  { sentence: "The debate highlighted ____ philosophical issues.", answer: "intricate" },

  
  { sentence: "Her grandmother's ____ nature made her beloved in the neighborhood.", answer: "benevolent" },
  { sentence: "Smartphones have become ____ in almost every household.", answer: "ubiquitous" },
  { sentence: "They reached a ____ agreement after hours of negotiation.", answer: "tentative" },
  { sentence: "The painting's colors were incredibly ____ in the dim light.", answer: "subtle" },
  { sentence: "The scientist provided a ____ explanation of the phenomenon.", answer: "comprehensive" },
  { sentence: "His ____ behavior made the whole team uncomfortable.", answer: "erratic" },
  { sentence: "The company faced a serious ____ after the data leak.", answer: "repercussion" },
  { sentence: "She had a ____ grasp of quantum mechanics.", answer: "profound" },
  { sentence: "The chef used a ____ blend of spices in the dish.", answer: "meticulous" },
  { sentence: "His performance was ____ and moved everyone to tears.", answer: "poignant" },

];

// game state variables
let index = 0;
let total = sentences.length;
let score = 0;
let correct = 0;
let skips = 0;

const sentenceEl = document.getElementById('sentence');
const lettersEl = document.getElementById('letters');
const slotsEl = document.getElementById('slots');
const textInput = document.getElementById('textInput');
const checkBtn = document.getElementById('checkBtn');
const shuffleBtn = document.getElementById('shuffleBtn');
const skipBtn = document.getElementById('skipBtn');
const revealBtn = document.getElementById('revealBtn');
const nextBtn = document.getElementById('nextBtn');
const feedbackEl = document.getElementById('feedback');

const scoreEl = document.getElementById('score');
const correctEl = document.getElementById('correct');
const skipsEl = document.getElementById('skips');
const indexEl = document.getElementById('index');
const totalEl = document.getElementById('total');

totalEl.textContent = total;

function shuffleArray(a){
  for (let i = a.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function prepareWord(word){
  return word.toLowerCase();
}

function scramble(word){
  const arr = word.split('');
  shuffleArray(arr);
  if (arr.join('') === word && word.length > 1) shuffleArray(arr);
  return arr;
}

let activeTiles = []; // {char, id, used}
let placed = []; // placed tile ids per slot, or null

function renderSentence(){
  const obj = sentences[index];
  sentenceEl.innerHTML = obj.sentence.replace('____', `<span class="text-amber-400 font-semibold">____</span>`);
  indexEl.textContent = index + 1;
}

function buildTilesAndSlots(){
  const ans = prepareWord(sentences[index].answer);
  const letters = ans.split('');
  activeTiles = letters.map((ch,i) => ({ char: ch, id: `t${i}`, used: false }));
  // scramble tiles for display
  shuffleArray(activeTiles);

  placed = Array.from({length: letters.length}, ()=> null);

  renderTiles();
  renderSlots(letters);
  textInput.value = '';
  feedbackEl.textContent = '';
}

function renderTiles(){
  lettersEl.innerHTML = '';
  activeTiles.forEach(tile => {
    const div = document.createElement('div');
    div.className = 'letter-tile bg-slate-800 text-slate-100 shadow-sm';
    if (tile.used) div.classList.add('held');
    div.textContent = tile.char.toUpperCase();
    div.dataset.id = tile.id;
    div.addEventListener('click', ()=> {
      if (tile.used){
        // Remove placed tile
        const pos = placed.indexOf(tile.id);
        if (pos >= 0) removePlacedAt(pos);
      } else {
        // Place tile in first empty slot
        const pos = placed.indexOf(null);
        if (pos !== -1){
          placed[pos] = tile.id;
          tile.used = true;
          updateSlotsUI();
          renderTiles();
          updateTextInputFromPlaced();
        }
      }
    });
    lettersEl.appendChild(div);
  });
}

function renderSlots(letterArray){
  slotsEl.innerHTML = '';
  letterArray.forEach((ch,i) => {
    const slot = document.createElement('div');
    slot.className = 'slot border border-white/6 px-2 cursor-pointer';
    slot.dataset.pos = i;
    slot.addEventListener('click', ()=> {
      removePlacedAt(i);
    });
    slot.textContent = '';
    slotsEl.appendChild(slot);
  });
}

function removePlacedAt(pos){
  if (pos < 0 || pos >= placed.length) return;
  const tileId = placed[pos];
  if (!tileId) return;
  const tile = activeTiles.find(t => t.id === tileId);
  if (tile){
    tile.used = false;
  }
  placed[pos] = null;
  updateSlotsUI();
  renderTiles();
  updateTextInputFromPlaced();
}

function updateSlotsUI(){
  const slotDivs = Array.from(slotsEl.querySelectorAll('.slot'));
  slotDivs.forEach((slot, i) => {
    const tileId = placed[i];
    if (tileId){
      const tile = activeTiles.find(t => t.id === tileId);
      slot.textContent = tile ? tile.char.toUpperCase() : '';
    } else {
      slot.textContent = '';
    }
  });
}

function updateTextInputFromPlaced(){
  const str = placed.map(id => {
    if (!id) return '';
    const tile = activeTiles.find(t => t.id === id);
    return tile ? tile.char : '';
  }).join('');
  textInput.value = str;
}

function populatePlacedFromText(){
  const raw = textInput.value.toLowerCase().replace(/[^a-z'-]/g, '');
  const capacity = placed.length;
  const arr = raw.slice(0, capacity).split('');
  activeTiles.forEach(t => t.used = false);
  placed = Array.from({length: capacity}, ()=> null);
  arr.forEach((ch, idx) => {
    const tile = activeTiles.find(t => !t.used && t.char === ch);
    if (tile){
      tile.used = true;
      placed[idx] = tile.id;
    }
  });
  renderTiles();
  updateSlotsUI();
}

textInput.addEventListener('input', () => {
  populatePlacedFromText();
});

checkBtn.addEventListener('click', () => checkAnswer(false));
shuffleBtn.addEventListener('click', () => {
  const unusedTiles = activeTiles.filter(t => !t.used).map(t => t.char);
  shuffleArray(unusedTiles);
  let ui = 0;
  activeTiles.forEach(t => {
    if (!t.used){
      t.char = unusedTiles[ui++];
    }
  });
  renderTiles();
  feedbackEl.textContent = 'Shuffled.';
  setTimeout(() => feedbackEl.textContent = '', 900);
});
skipBtn.addEventListener('click', () => {
  skips++;
  score = Math.max(0, score - 5);
  updateStats();
  feedbackEl.textContent = 'Skipped. -5 points';
  setTimeout(() => feedbackEl.textContent = '', 1000);
  nextItem();
});
revealBtn.addEventListener('click', () => {
  feedbackEl.innerHTML = `Answer: <span class="font-semibold text-amber-300">${sentences[index].answer}</span>`;
  autoFillAnswer();
});
nextBtn.addEventListener('click', () => nextItem());

function checkAnswer(forceReveal){
  const userAnswer = (textInput.value || getPlacedString()).toLowerCase().trim();
  const correctAns = sentences[index].answer.toLowerCase();
  if (userAnswer === correctAns){
    score += 10;
    correct++;
    feedbackEl.textContent = 'Correct! +10';
    updateStats();
    setTimeout(() => {
      nextItem();
    }, 800);
  } else {
    feedbackEl.textContent = 'Incorrect — try again or Skip.';
  }
}

function getPlacedString(){
  return placed.map(id => {
    if (!id) return '';
    const tile = activeTiles.find(t => t.id === id);
    return tile ? tile.char : '';
  }).join('');
}

function autoFillAnswer(){
  const ans = prepareWord(sentences[index].answer);
  const letters = ans.split('');
  activeTiles.forEach(t => t.used = false);
  placed = Array.from({length: letters.length}, () => null);
  letters.forEach((ch, i) => {
    const tile = activeTiles.find(t => !t.used && t.char === ch);
    if (tile){
      tile.used = true;
      placed[i] = tile.id;
    }
  });
  renderTiles();
  updateSlotsUI();
  updateTextInputFromPlaced();
}

function nextItem(){
  index++;
  if (index >= total){
    feedbackEl.innerHTML = `Game finished! Final score: <strong>${score}</strong>. You got ${correct} correct, skipped ${skips}.`;
    updateStats();
    sentenceEl.textContent = 'All done — well played!';
    lettersEl.innerHTML = '';
    slotsEl.innerHTML = '';
    textInput.disabled = true;
    checkBtn.disabled = true;
    shuffleBtn.disabled = true;
    skipBtn.disabled = true;
    revealBtn.disabled = true;
    nextBtn.disabled = true;
    return;
  }
  renderSentence();
  buildTilesAndSlots();
  updateStats();
}

function updateStats(){
  scoreEl.textContent = score;
  correctEl.textContent = correct;
  skipsEl.textContent = skips;
  indexEl.textContent = Math.min(index + 1, total);
}

function startGameAt(i=0){
  index = i;
  score = 0;
  correct = 0;
  skips = 0;
  textInput.disabled = false;
  checkBtn.disabled = false;
  shuffleBtn.disabled = false;
  skipBtn.disabled = false;
  revealBtn.disabled = false;
  nextBtn.disabled = false;
  renderSentence();
  buildTilesAndSlots();
  updateStats();
}
startGameAt(0);

textInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    checkAnswer(false);
  }
});
</script>
</body>
</html>
